var deskShell = {
	v:0.1
	,status:'awaitingSocket'
	,ready:function(callback) {
		deskShell.readyCallbacks.push(callback);
		if (deskShell.status == 'ready') {
			callback(deskShell);
		}
	},readyCallbacks:[]
	,sendMessage:function(name,data) {
		deskShell.socket.emit(name,data);
	},exitApp:function() {
		deskShell.socket.emit('exitApp',{});
		setTimeout(function() {window.close();},500);
	}
}
if (io) {
	deskShell.socket = io.connect('http://localhost:'+location.port);
	deskShell.socket.on('deskShell', function (data) {
		for(var i in data) {
			deskShell[i] = data[i];
		}
		deskShell.status = 'ready';
		for(var c in deskShell.readyCallbacks) {
			deskShell.readyCallbacks[c](deskShell);
		}
	});
}